class MeshProcess{constructor(a,b){let c=this;function d(){let e={'vertices':[],'normals':[],'uv':[]};return e;};this['Copy']=function(e,f,g,h,l,m){h['ID']+=f;let n=0x0,o;o=e['getInt32'](n,!![]),n+=0x4;for(let p=0x0;p<o;p++){let q=new b['Color']();q['r']=e['getUint8'](n,!![]),q['g']=e['getUint8'](n+0x1,!![]),q['b']=e['getUint8'](n+0x2,!![]),q['a']=e['getUint8'](n+0x3,!![]),n+=0x4;let r=e['getUint32'](n,!![]);n+=0x4;let s=e['getUint32'](n,!![]);n+=0x4;let t=e['getUint32'](n,!![]);n+=0x4;let u=0x0;l['version']>=0x131&&(u=e['getUint32'](n,!![]),n+=0x4);let v,w=0.5,x=0x0,y=0x0;if(a['Loader']['parsetype']===0x1){let J=e['getUint32'](n,!![]);n+=0x4;}let z=new Float32Array(g,n+e['byteOffset'],r);n+=r*0x4;let A=new Float32Array(g,n+e['byteOffset'],s);n+=s*0x4;let B=new Uint32Array(g,n+e['byteOffset'],t);n+=t*0x4;let C;l['version']>=0x131&&u>0x0&&(C=new Float32Array(g,n+e['byteOffset'],u),n+=u*0x4);let D=a['Data']['Object3D']();D['index']=m,D['attribs']['a_index']['array']=B,D['numElements']=D['attribs']['a_index']['array']['length'],D['attribs']['a_position']['array']=z,D['attribs']['a_normal']['array']=A;let E=new Uint16Array(A['length']);for(let K=0x0;K<A['length'];K++){E[K]=0x0;}D['attribs']['a_matrixIndex']['array']=E;u>0x0&&a['Data']['Parent']()['UV_DEBUG']&&(D['attribs']['a_uv']['array']=C);let F=e['getUint32'](n,!![]);n+=0x4;let G=[],H=[],I=0x0;for(let L=0x0;L<F;L++){let M=e['getUint32'](n,!![]);n+=0x4;let N=e['getUint32'](n,!![]);n+=0x4;let O=e['getUint32'](n,!![]);n+=0x4;let P=e['getUint32'](n,!![]);n+=0x4;let Q=0x0;l['version']>=0x131&&(Q=e['getUint32'](n,!![]),n+=0x4);let R=e['getUint16'](n,!![]);n+=0x2;let S=e['getUint16'](n,!![]);n+=0x2;let T=0x0;l['version']>=0x131&&(T=e['getUint32'](n,!![]),n+=0x4);let U=new Float32Array(e['buffer'],n+e['byteOffset'],0x6);n+=0x18;if(a['Data']['Parent']()['UV_DEBUG']){let V={'partId':M+a['Data']['GetStartID'](h['ID']),'bodyId':N+a['Data']['GetStartID'](h['ID']),'color':q,'material':0x0,'m_vnIdx':O*0x3,'m_triIdx':P*0x3,'m_uvIdx':Q*0x2,'m_nVtx':R*0x3,'m_nTris':S*0x3,'m_nUV':T*0x2,'BBox':new b['BBox'](U),'action':a['Data']['ActionItem'](),'colorIdx':null,'object':null};a['Data']['IDColor']['new'](),V['action']['transform']['setPosition'](a['Data']['TmpTransform']),V['colorIdx']=a['Data']['IDColor']['r']+(a['Data']['IDColor']['g']<<0x8)+(a['Data']['IDColor']['b']<<0x10)+a['Data']['IDColor']['a']*0x1000000;let W=V['m_nVtx']/0x3*0x4;for(let X=0x0;X<W;X=X+0x4){H[I+X+0x0]=a['Data']['IDColor']['r'],H[I+X+0x1]=a['Data']['IDColor']['g'],H[I+X+0x2]=a['Data']['IDColor']['b'],H[I+X+0x3]=a['Data']['IDColor']['a'];}I+=W,V['object']=D,G['push'](V),a['Data']['AddBody'](V);}else{let Y={'partId':M+a['Data']['GetStartID'](h['ID'])+f*0x2710,'bodyId':N+a['Data']['GetStartID'](h['ID'])+f*0x2710,'color':q,'m_vnIdx':O*0x3,'m_triIdx':P*0x3,'m_nVtx':R*0x3,'m_nTris':S*0x3,'BBox':new b['BBox'](U),'action':a['Data']['ActionItem'](),'colorIdx':null,'object':null};a['Data']['IDColor']['new']();let Z,a0=0x0,a1=0x0,a2=0x1,a3=0x1;f<0x5?(a0=0x4e20,a1=0x0,a2=f,a3=0x1):(a0=0x4e20,a1=0x15f90,a2=f%0x5,a3=0x1);Z=new b['Vector3'](a0*a2,a1*a3,0x0),Y['colorIdx']=a['Data']['IDColor']['r']+(a['Data']['IDColor']['g']<<0x8)+(a['Data']['IDColor']['b']<<0x10)+a['Data']['IDColor']['a']*0x1000000;let a4=Y['m_nVtx']/0x3*0x4;for(let a5=0x0;a5<a4;a5=a5+0x4){H[I+a5+0x0]=a['Data']['IDColor']['r'],H[I+a5+0x1]=a['Data']['IDColor']['g'],H[I+a5+0x2]=a['Data']['IDColor']['b'],H[I+a5+0x3]=a['Data']['IDColor']['a'];}I+=a4,Y['object']=D,G['push'](Y),a['Data']['AddBody'](Y);{let a6=c['GetAABBFromMatrix']([Y]);Y['BBox']=a6;}Y['action']['transform']['setPosition'](Z),Y['action']['instance']['setPosition'](Z);}}D['attribs']['a_color']['array']=new Uint8Array(H,0x0,I),a['Data']['Objects']['push'](D),D['tag']=G;if(a['Data']['Parent']()['DataSplit']!==0x0){let a7=a['Data']['ModelFileManager']['GetFileAreaData'](h['Key'],h['Url']);a7&&a7['objects']['push'](D);}m++;}},this['GetAABBFromMatrix']=function(e){if(e===undefined)return new b['BBox']();let f=new b['Matrix4'](),g=new b['BBox']();for(let h=0x0;h<e['length'];h++){let j=e[h],l=a['Data']['ShapeAction']['GetAction'](j['object']['id_file'],j['origin_id']),m=!![],n=![];if(!f['equals'](l['transform']))n=!![];let o=new b['Vector3'](),p=new b['Vector3']();for(let q=j['m_triIdx'];q<j['m_triIdx']+j['m_nTris'];q++){let r=j['object']['attribs']['a_index']['array'][q],s=new b['Vector3'](j['object']['attribs']['a_position']['array'][r*0x3+0x0],j['object']['attribs']['a_position']['array'][r*0x3+0x1],j['object']['attribs']['a_position']['array'][r*0x3+0x2]),t=new b['Vector3']()['copy'](s);if(n)t['applyMatrix4'](l['transform']);m?(o['copy'](t),p['copy'](t),m=![]):(o['min'](t),p['max'](t));}h===0x0?(g['min']['copy'](o),g['max']['copy'](p)):(g['min']['min'](o),g['max']['max'](p));}return g['update'](),g;},this['GetBoundboxVertices']=function(e){let f=a['Util']['GetBBox2Vertex'](e),g=[[0x0,0x1,0x2],[0x2,0x1,0x3],[0x5,0x4,0x6],[0x5,0x6,0x7],[0x0,0x2,0x4],[0x4,0x2,0x6],[0x3,0x1,0x5],[0x3,0x5,0x7],[0x2,0x3,0x6],[0x6,0x3,0x7],[0x1,0x0,0x4],[0x1,0x4,0x5]],h=0x0,i=[],j=[];for(let m=0x0;m<0xc;m++){for(let o=0x0;o<0x3;o++){i[h]=f[g[m][o]],h++;}let n=a['Util']['GetTriangleNormal'](i[h-0x3],i[h-0x2],i[h-0x1]);j[h-0x3]=n,j[h-0x2]=n,j[h-0x1]=n;}let l=d();return l['vertices']=i,l['normals']=j,l;},this['Get2DCircleVertices']=function(e,f,g,h,i){let k=[];for(let m=h;m<=i;m+=0xa){let n=m/0xb4*3.141592654,o=e['x']+Math['cos'](n)*f,p=e['y']+Math['sin'](n)*g;k['push'](new b['Vector3'](o,p,e['z']));}let l=d();return l['vertices']=k,l;},this['Get2D3DCircleVertices']=function(e,f,g,h,i,k){let l=[];for(let n=i;n<=k;n+=0xa){let o=n/0xb4*3.141592654,p=new b['Vector3']()['copy'](f)['multiplyScalar'](Math['cos'](o)*h),q=new b['Vector3']()['copy'](g)['multiplyScalar'](Math['sin'](o)*h),r=new b['Vector3']()['copy'](e);r=r['add'](new b['Vector3']()['addVectors'](p,q)),l['push'](r);}{let s=k/0xb4*3.141592654,t=new b['Vector3']()['copy'](f)['multiplyScalar'](Math['cos'](s)*h),u=new b['Vector3']()['copy'](g)['multiplyScalar'](Math['sin'](s)*h),v=new b['Vector3']()['copy'](e);v=v['add'](new b['Vector3']()['addVectors'](t,u)),l['push'](v);}let m=d();return m['vertices']=l,m;},this['GetPanel3DVertices']=function(e,f,g,h,i,j){let l=[],m=0x0,n=[],o=0x0,p=[],q=0x0,r,s,t,u;j?(r=new b['Vector3']()['addVectors'](e,new b['Vector3']()['addVectors'](new b['Vector3']()['copy'](f)['multiplyScalar'](-h*0.5),new b['Vector3']()['copy'](g)['multiplyScalar'](-i*0.5))),s=new b['Vector3']()['addVectors'](e,new b['Vector3']()['addVectors'](new b['Vector3']()['copy'](f)['multiplyScalar'](-h*0.5),new b['Vector3']()['copy'](g)['multiplyScalar'](i*0.5))),t=new b['Vector3']()['addVectors'](e,new b['Vector3']()['addVectors'](new b['Vector3']()['copy'](f)['multiplyScalar'](h*0.5),new b['Vector3']()['copy'](g)['multiplyScalar'](-i*0.5))),u=new b['Vector3']()['addVectors'](e,new b['Vector3']()['addVectors'](new b['Vector3']()['copy'](f)['multiplyScalar'](h*0.5),new b['Vector3']()['copy'](g)['multiplyScalar'](i*0.5)))):(r=new b['Vector3']()['copy'](e),s=new b['Vector3']()['addVectors'](e,new b['Vector3']()['copy'](g)['multiplyScalar'](i)),t=new b['Vector3']()['addVectors'](e,new b['Vector3']()['copy'](f)['multiplyScalar'](h)),u=new b['Vector3']()['addVectors'](e,new b['Vector3']()['addVectors'](new b['Vector3']()['copy'](f)['multiplyScalar'](h),new b['Vector3']()['copy'](g)['multiplyScalar'](i))));{l[m]=r['x'],m++,l[m]=r['y'],m++,l[m]=r['z'],m++,l[m]=s['x'],m++,l[m]=s['y'],m++,l[m]=s['z'],m++,l[m]=t['x'],m++,l[m]=t['y'],m++,l[m]=t['z'],m++,l[m]=s['x'],m++,l[m]=s['y'],m++,l[m]=s['z'],m++,l[m]=t['x'],m++,l[m]=t['y'],m++,l[m]=t['z'],m++,l[m]=u['x'],m++,l[m]=u['y'],m++,l[m]=u['z'],m++;}{let x=a['Util']['GetTriangleNormal'](r,t,s),y=a['Util']['GetTriangleNormal'](s,t,u);n[o]=x['x'],o++,n[o]=x['y'],o++,n[o]=x['z'],o++,n[o]=x['x'],o++,n[o]=x['y'],o++,n[o]=x['z'],o++,n[o]=x['x'],o++,n[o]=x['y'],o++,n[o]=x['z'],o++,n[o]=y['x'],o++,n[o]=y['y'],o++,n[o]=y['z'],o++,n[o]=y['x'],o++,n[o]=y['y'],o++,n[o]=y['z'],o++,n[o]=y['x'],o++,n[o]=y['y'],o++,n[o]=y['z'],o++;}let v=[0x0,0x0,0x0,0x1,0x1,0x0,0x0,0x1,0x1,0x0,0x1,0x1];for(let z=0x0,A=v['length'];z<A;z++){p[q]=v[z],q++;}let w=d();return w['vertices']=l,w['normals']=n,w['uv']=p,w;},this['GetRectangle3D']=function(e,f,g,h,j){let k=[],l=0x0,m=[],n=0x0;k[l]=e['x'],l++,k[l]=e['y'],l++,k[l]=e['z'],l++,k[l]=f['x'],l++,k[l]=f['y'],l++,k[l]=f['z'],l++,k[l]=g['x'],l++,k[l]=g['y'],l++,k[l]=g['z'],l++,k[l]=h['x'],l++,k[l]=h['y'],l++,k[l]=h['z'],l++,k[l]=e['x'],l++,k[l]=e['y'],l++,k[l]=e['z'],l++;if(j===undefined){let p=new b['Vector3']()['subVectors'](f,e),q=new b['Vector3']()['subVectors'](g,e);j=new b['Vector3'](),j['crossVectors'](p,q),j['normalize']();}if(j!==undefined)for(let r=0x0;r<0x5;r++){m[n]=j['x'],n++,m[n]=j['y'],n++,m[n]=j['z'],n++;}let o=d();return o['vertices']=k,o['normals']=m,o;},this['GetCylinderSide3DVertices']=function(e,f,g){let h=new b['Vector3']()['subVectors'](f,e);h['normalize']();let j=new b['Vector3'](0x1,0x0,0x0);(j['dot'](h)>0.99||j['dot'](h)<-0.99)&&(j=new b['Vector3'](0x0,0x1,0x0));let k=new b['Vector3']()['crossVectors'](h,j);j=new b['Vector3']()['crossVectors'](k,h),j['normalize'](),k['normalize'](),h['normalize']();let l=0xa,m=[],n=[];for(let p=0x0;p<l+0x1;p++){let q=Math['PI']*0x2/l*p,r=new b['Vector3']()['copy'](j)['multiplyScalar'](Math['cos'](q)),s=new b['Vector3']()['copy'](r)['multiplyScalar'](g),t=new b['Vector3']()['copy'](k)['multiplyScalar'](Math['sin'](q)),u=new b['Vector3']()['copy'](t)['multiplyScalar'](g),v=new b['Vector3']()['addVectors'](e,new b['Vector3']()['addVectors'](s,u));m['push'](v);let w=new b['Vector3']()['addVectors'](r,t);n['push'](w),v=new b['Vector3']()['addVectors'](f,new b['Vector3']()['addVectors'](s,u)),m['push'](v),n['push'](w);}let o=d();return o['vertices']=m,o['normals']=n,o;},this['GetLine']=function(e,f,g){let h=new b['Vector3']()['subVectors'](f,e);h['normalize']();let j=new b['Vector3'](0x1,0x0,0x0);(j['dot'](h)>0.99||j['dot'](h)<-0.99)&&(j=new b['Vector3'](0x0,0x1,0x0));let k=new b['Vector3']()['crossVectors'](h,j);j=new b['Vector3']()['crossVectors'](k,h),j['normalize'](),k['normalize'](),h['normalize']();let l=new b['Vector3']()['copy'](j)['multiplyScalar'](-0x1),m=[],n=[];m[0x0]=new b['Vector3']()['copy'](e),m[0x1]=new b['Vector3']()['copy'](e),m[0x2]=new b['Vector3']()['copy'](f),m[0x3]=new b['Vector3']()['copy'](f),m[0x4]=new b['Vector3']()['copy'](f),m[0x5]=new b['Vector3']()['copy'](e),n[0x0]=new b['Vector3']()['copy'](j),n[0x1]=new b['Vector3']()['copy'](l),n[0x2]=new b['Vector3']()['copy'](j),n[0x3]=new b['Vector3']()['copy'](j),n[0x4]=new b['Vector3']()['copy'](l),n[0x5]=new b['Vector3']()['copy'](l);if(g!==undefined)for(let p=0x0;p<0x6;p++){m[p]=m[p]['add'](new b['Vector3']()['copy'](n[p])['multiplyScalar'](g));}let o=d();return o['vertices']=m,o['normals']=n,o;},this['GetLine2']=function(e,f){let g=new b['Vector3']()['subVectors'](f,e);g['normalize']();let h=new b['Vector3'](0x1,0x0,0x0);(h['dot'](g)>0.99||h['dot'](g)<-0.99)&&(h=new b['Vector3'](0x0,0x1,0x0));let i=new b['Vector3']()['crossVectors'](g,h);h=new b['Vector3']()['crossVectors'](i,g),h['normalize'](),i['normalize'](),g['normalize']();let j=new b['Vector3']()['copy'](h)['multiplyScalar'](-0x1),k=[],l=[];k[0x0]=new b['Vector3']()['copy'](e),k[0x1]=new b['Vector3']()['copy'](f),l[0x0]=new b['Vector3']()['copy'](h),l[0x1]=new b['Vector3']()['copy'](j);let m=d();return m['vertices']=k,m['normals']=l,m;};}}export default MeshProcess;